---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import Header from "../../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="cn">
	<head>
		<BaseHead
			title={`博客文章 | ${SITE_TITLE}`}
			description={SITE_DESCRIPTION}
		/>
		<style>
			/* Blog List Specific Styles */
			.back-nav-container {
				color: var(--text-primary);
				letter-spacing: 2px;
				text-transform: uppercase;
				align-items: center;
				padding-bottom: 0;
				font-weight: 500;
				display: flex;
				margin-bottom: 2rem;
			}

			.back-nav-button {
				color: var(--text-primary);
				background-color: rgba(0, 0, 0, 0);
				border-radius: var(--border-radius);
				margin-top: -12px;
				padding: 12px 16px;
				text-decoration: none;
				transition: all var(--transition-fast);
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.back-nav-button:hover {
				backdrop-filter: blur(4px);
				background-color: rgba(8, 8, 8, 0.24);
			}

			.back-nav-img {
				width: 18px;
			}

			.content-container {
				grid-column-gap: 32px;
				grid-row-gap: 32px;
				flex-direction: column;
				display: flex;
			}

			.items-container {
				flex-direction: column;
			}

			.resource-items {
				grid-column-gap: 64px;
				grid-row-gap: 64px;
				flex-direction: column;
				display: flex;
			}

			.single-item {
				font-size: 16px;
				background-color: var(--bg-card);
				border-radius: var(--border-radius-lg);
				padding: 2rem;
				border: 1px solid var(--border-primary);
				transition: all var(--transition-smooth);
			}

			.single-item:hover {
				transform: translateY(-4px);
				box-shadow: var(--shadow-lg);
			}

			.single-item a {
				text-decoration: none;
				color: inherit;
			}

			.single-item h3 {
				color: var(--text-primary);
				margin-bottom: 1rem;
				font-size: 24px;
			}

			.single-item h3:hover {
				color: var(--accent);
			}

			.post-image {
				width: 100%;
				height: 200px;
				object-fit: cover;
				border-radius: var(--border-radius);
				margin-bottom: 1.5rem;
			}

			.post-meta {
				display: flex;
				align-items: center;
				gap: 1rem;
				margin-bottom: 1rem;
			}

			.post-date {
				color: var(--text-secondary);
				font-family: "IBM Plex Mono", sans-serif;
				font-size: 12px;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.post-description {
				color: var(--text-secondary);
				line-height: 24px;
				margin-bottom: 1.5rem;
			}

			.post-tags {
				display: flex;
				flex-wrap: wrap;
				gap: 0.5rem;
			}

			.post-tag {
				background-color: var(--chip-bg);
				color: var(--chip-text);
				padding: 4px 8px;
				border-radius: var(--border-radius);
				font-family: "IBM Plex Mono", sans-serif;
				font-size: 10px;
				text-transform: uppercase;
			}

			/* Featured Post */
			.featured-post {
				background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-card));
				border: 2px solid var(--accent);
				position: relative;
			}

			.featured-post::before {
				content: "FEATURED";
				position: absolute;
				top: -1px;
				right: 1rem;
				background: var(--accent);
				color: var(--text-primary);
				padding: 0.25rem 0.75rem;
				font-size: 10px;
				font-weight: 600;
				letter-spacing: 1px;
				border-radius: 0 0 var(--border-radius) var(--border-radius);
			}

			.featured-post .post-image {
				height: 250px;
			}

			.featured-post h3 {
				font-size: 28px;
				background: linear-gradient(135deg, var(--accent), #5a9fd4);
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
				background-clip: text;
			}
		</style>
	</head>
	<body>
		<div class="content">
			<Header selectedItem="blog" />
			<nav class="main">
				<div class="container">
					<div class="back-nav-container">
						<a href="/" class="back-nav-button">
							<svg class="back-nav-img" fill="currentColor" viewBox="0 0 24 24">
								<path
									d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
								></path>
							</svg>
							<div>Back</div>
						</a>
					</div>
					<div class="content-container">
						<h1>博客文章</h1>
						<section class="items-container">
							<div class="resource-items">
								{
									posts.map((post, index) => (
										<div
											class={`single-item ${index === 0 ? "featured-post" : ""}`}
										>
											<a href={`/blog/${post.id}/`}>
												{post.data.heroImage && (
													<Image
														class="post-image"
														width={720}
														height={360}
														src={post.data.heroImage}
														alt=""
													/>
												)}
												<div class="post-meta">
													<div class="post-date">
														<FormattedDate date={post.data.pubDate} />
													</div>
												</div>
												<h3>{post.data.title}</h3>
												<div class="post-description">
													{post.data.description}
												</div>
												<div class="post-tags">
													<div class="post-tag">技术</div>
													<div class="post-tag">教程</div>
												</div>
											</a>
										</div>
									))
								}
							</div>
						</section>
					</div>
				</div>
			</nav>
		</div>
	</body>
</html>
